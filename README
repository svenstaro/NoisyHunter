Implementation of http://www.squidi.net/three/entry.php?id=85
